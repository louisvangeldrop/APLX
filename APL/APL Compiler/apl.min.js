(function(){var r,t,n,i;macro(function(){this.tmpCounter=0;this.tmp=function(){return"t"+this.tmpCounter++}});macro(withAlphaAndOmega(function(n){return n.body.subst({"⍺":macro.codeToNode(function(){return alpha}),"⍵":macro.codeToNode(function(){return omega})})}));macro(include(function(n){return macro.fileToNode("src/"+macro.nodeToVal(n)+".coffee")}));include("helpers");include("errors");include("array");include("complex");include("vm");include("lexer");include("parser");i={};r=function(n){var t,r;for(t in n)r=n[t],i[t]=r};withAlphaAndOmega(function(){return include("vocabulary/vhelpers"),include("vocabulary/arithmetic"),include("vocabulary/backslash"),include("vocabulary/circle"),include("vocabulary/comma"),include("vocabulary/comparisons"),include("vocabulary/compose"),include("vocabulary/cupcap"),include("vocabulary/decode"),include("vocabulary/dot"),include("vocabulary/each"),include("vocabulary/encode"),include("vocabulary/epsilon"),include("vocabulary/exclamation"),include("vocabulary/execute"),include("vocabulary/find"),include("vocabulary/floorceil"),include("vocabulary/fork"),include("vocabulary/format"),include("vocabulary/grade"),include("vocabulary/identity"),include("vocabulary/iota"),include("vocabulary/leftshoe"),include("vocabulary/logic"),include("vocabulary/poweroperator"),include("vocabulary/quad"),include("vocabulary/question"),include("vocabulary/raise"),include("vocabulary/rho"),include("vocabulary/rotate"),include("vocabulary/slash"),include("vocabulary/squish"),include("vocabulary/take"),include("vocabulary/transpose"),include("vocabulary/variant"),include("compiler")});this.apl=t=function(n,i){return t.ws(i)(n)};extend(t,{format:format,approx:approx,parse:parse,compileAST:compileAST,repr:repr});t.ws=function(n){var t;return n==null&&(n={}),t=Object.create(i),n["in"]&&(t["get_⎕"]=t["get_⍞"]=function(){var t;return t=n["in"](),assert(typeof t=="string"),new A(t)}),n.out&&(t["set_⎕"]=t["set_⍞"]=function(t){return n.out(format(t).join("\n")+"\n")}),function(n){return exec(n,{ctx:t})}};n=function(t,i){var r;if((n.requesters!=null?n.requesters:n.requesters=[]).push(i),!(r=n.rl)){r=n.rl=require("readline").createInterface(process.stdin,process.stdout);r.on("line",function(t){var i;if(typeof(i=n.requesters.pop())=="function")return i(t)});r.on("close",function(){return process.stdout.write("\n"),process.exit(0)})}return r.setPrompt(t),r.prompt()};typeof module!="undefined"&&module!==null&&(module.exports=t,module===(typeof require!="undefined"&&require!==null?require.main:void 0)&&function(){var i,u,h,r,c,o,f,l,e,a,s;for(f="Usage: apl.js [options] [filename.apl]\nOptions:\n  -l --linewise   Process stdin line by line and disable prompt\n",r=null,o=0,s=process.argv.slice(2),e=0,a=s.length;e<a;e++)i=s[e],i==="-h"||i==="--help"?(process.stderr.write(f),process.exit(0)):i==="-l"||i==="--linewise"?o=1:/^-/.test(i)?(process.stderr.write("unrecognized option: "+i+"\n"+f),process.exit(1)):r!=null?(process.stderr.write(f),process.exit(1)):r=i;r!=null?exec(require("fs").readFileSync(r,"utf8")):o?function(){var n,u,e,o,i,f,r,s;for(o=require("fs"),s=t.ws(),n=Buffer(256),i=r=0,u=Buffer(n.length);f=o.readSync(0,u,0,u.length,null);)for(r+f>n.length&&(n=Buffer.concat([n,n])),u.copy(n,r,0,f),r+=f;i<r;)n[i]===10?(process.stdout.write(function(){try{return format(s(""+n.slice(0,i))).join("\n")+"\n"}catch(t){return e=t,e+"\n"}}()),n.copy(n,0,i+1),r-=i+1,i=0):i++}():require("tty").isatty()?(l=t.ws(),n("      ",h=function(t){var i;try{t.match(/^[\ \t\f\r\n]*$/)||process.stdout.write(format(l(t)).join("\n")+"\n")}catch(r){i=r;process.stdout.write(i+"\n")}n("      ",h)})):exec(Buffer.concat(function(){for(var n=[];;){if(u=new Buffer(1024),!(c=require("fs").readSync(0,u,0,u.length,null)))break;n.push(u.slice(0,c))}return n}()).toString("utf8"))}())}).call(this);
//# sourceMappingURL=apl.min.js.map
